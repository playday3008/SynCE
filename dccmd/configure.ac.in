dnl Process this file with autoconf to produce a configure script.
AC_PREREQ(2.53)
AC_INIT(src/dccm.c)

AC_CANONICAL_TARGET

AM_INIT_AUTOMAKE(dccm, YOU_DID_NOT_RUN_THE_BOOTSTRAP_SCRIPT)
AM_CONFIG_HEADER(dccm_config.h)

CFLAGS="-Wall $CFLAGS"

case $target in

	powerpc-apple-*)
		dnl Prevent "Undefined Macro argument list" error.
		CFLAGS="-no-cpp-precomp $CFLAGS"
		;;

esac

dnl Checks for programs.
AC_PROG_AWK
AC_PROG_CC
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_LIBTOOL
AC_PROG_MAKE_SET

dnl Check for libsynce
PKG_CHECK_MODULES(LIBSYNCE, libsynce >= 0.9.1)

dnl Checks for header files.

dnl Checks for typedefs, structures, and compiler characteristics.
saved_CFLAGS="$CFLAGS"
CFLAGS=""
AC_C_CONST
CFLAGS="$saved_CFLAGS"

AC_REPLACE_FUNCS(daemon)

dnl Prevent "NONE" used as prefix!
test "x$prefix" = xNONE && eval prefix=$ac_default_prefix
test "x$exec_prefix" = xNONE && eval exec_prefix='${prefix}'

eval SYNCE_BINDIR="${bindir}"
AC_SUBST(SYNCE_BINDIR)

AC_CONFIG_FILES(
	[script/synce-sound],
	[chmod +x script/synce-sound]
)

AC_OUTPUT([Makefile
           src/Makefile
					 man/Makefile
           script/Makefile])


dnl Process this file with autoconf to produce a configure script.
AC_PREREQ(2.53)
AC_INIT(src/multisync_plugin.c)

GNOME_INIT

AC_CANONICAL_TARGET

AM_INIT_AUTOMAKE(multisync_plugin, YOU_DID_NOT_RUN_THE_BOOTSTRAP_SCRIPT)
AM_CONFIG_HEADER(multisync_plugin_config.h)

AC_SUBST(APPLE_CFLAGS)
case $target in

	powerpc-apple-*)
		dnl Prevent "Undefined Macro argument list" error.
		APPLE_CFLAGS="-no-cpp-precomp"
		;;

	*)
		APPLE_CFLAGS=""
		;;

esac

dnl Checks for programs.
AC_PROG_AWK
AC_PROG_CC
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_LIBTOOL
AC_PROG_MAKE_SET

dnl Check for SynCE libs
AM_PATH_LIBSYNCE
AM_PATH_LIBRAPI2
AM_PATH_RRA

AC_SUBST(MULTISYNC_INCLUDE)
AC_ARG_WITH(multisync-source,
	AC_HELP_STRING(
		[--with-multisync-source[=DIR]],
		[Search for Multisync source in DIR]),
		[
			MULTISYNC_INCLUDE=${withval}/src
		]
	)

AC_ARG_WITH(multisync-include,
	AC_HELP_STRING(
		[--with-multisync-include[=DIR]],
		[Search for Multisync header files in DIR]),
		[
			MULTISYNC_INCLUDE=${withval}
		]
	)

AC_CHECK_FILES(${MULTISYNC_INCLUDE}/syncengine.h,,[
	AC_MSG_ERROR([Can't find Multisync header syncengine.h])
	])


dnl Checks for header files.

dnl Checks for typedefs, structures, and compiler characteristics.
AC_C_CONST

AC_SUBST(CFLAGS)
AC_SUBST(CPPFLAGS)
AC_SUBST(LDFLAGS)

AC_OUTPUT([Makefile
           src/Makefile])

